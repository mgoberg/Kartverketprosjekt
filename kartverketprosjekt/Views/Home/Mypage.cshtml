@model List<kartverketprosjekt.Models.SakModel>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Min Side";
}

<a asp-controller="Home" asp-action="Index">
    <i class='bx bx-chevron-left'></i>
</a>
<h1>Min Side</h1>

<!-- Tilbakemeldinger -->
@if (TempData["SuccessMessage"] != null)
{
    <div style="color:green;">@TempData["SuccessMessage"]</div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div style="color:red;">@TempData["ErrorMessage"]</div>
}

<div class="box-container">
    <div class="instillinger">
 <h2>Kontoinstillinger </h2>
        <!-- Form for Updating Name -->
        <form asp-controller="Bruker" asp-action="UpdateName" method="post" style="margin-top: 20px;">
            @Html.AntiForgeryToken() <!-- Ensure this is included for security -->
            <div>
                <label for="Navn">Oppdater navnet ditt</label>
                <input type="text" id="Navn" name="navn" placeholder="Skriv inn nytt navn" required />
            </div>
            <button type="submit" class="btn-primary">Oppdater Navn</button>
        </form>
        <!-- Endre Passord Form -->
        <form asp-controller="Bruker" asp-action="UpdatePassword" method="post" style="margin-top: 0px;">
            @Html.AntiForgeryToken()
            <div>
                <label for="Password">Nytt passord:</label>
                <input type="password" id="Password" name="Password" placeholder="Skriv inn nytt passord" required />
            </div>
            <button type="submit" class="btn-primary">Oppdater Passord</button>
        </form>

    </div>
    <style>
        .status-ikke-påbegynt {
            color: green;
        }

        .status-in-progress {
            color: orange;
        }

        .status-completed {
            color: blue;
        }

        .status-closed {
            color: red;
        }

        .status-arkivert {
            color: grey;
        }
    </style>

    <div class="box">
        <h2>Oversikt over dine saker</h2>
        @if (Model != null && Model.Count > 0)
        {
            <ul>
                @foreach (var sak in Model)
                {
                    // Assign the appropriate CSS class based on the status
                    string statusClass = sak.status switch
                    {
                        "Ikke Påbegynt" => "status-ikke-påbegynt",
                        "Under behandling" => "status-in-progress",
                        "Fullført" => "status-completed",
                        "Lukket" => "status-closed",
                        "Arkivert" => "status-arkivert", // Added case for 'Arkivert'
                        _ => string.Empty
                    };

                    <li>
                        <strong>@sak.Kommunenavn</strong> -
                        <strong>Status: <span class="@statusClass">@sak.status</span></strong> -
                        Opprettet: @sak.opprettet_dato.ToString("d")
                    </li>
                }
            </ul>
        }
        else
        {
            <p>Du har ingen saker.</p>
        }
    </div>


</div>
